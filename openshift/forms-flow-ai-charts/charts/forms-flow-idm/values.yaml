---
keycloak:
  auth:
    tls:
      enabled: true
      autoGenerated: true
  extraEnvVars: 
    - name: KEYCLOAK_ADMIN_USER
      value: admin
    - name: KEYCLOAK_EXTRA_ARGS
      value: "-Dkeycloak.import=/realm/realm.json" 
    - name: KEYCLOAK_PROXY_ADDRESS_FORWARDING
      value: "true"
    - name: JAVA_OPTS
      value: >-
        -Dkeycloak.profile.feature.scripts=enabled
        -Dkeycloak.profile.feature.upload_scripts=enabled
        -Djava.net.preferIPv4Stack=true

  extraVolumes: 
    - name: "forms-flow-idm-realm-config"
      configMap:
        name: "forms-flow-idm"

  extraVolumeMounts: 
    - name: "forms-flow-idm-realm-config"
      mountPath: "/realm/"
      readOnly: true
    
  image:
    registry: "docker.io"
    repository: "bitnami/keycloak" 
    tag: 14.0.0

  postgresql:
    auth:
      database: forms-flow-idm # Name for custom database to create
      postgresPassword: postgres # Password for the "postgres" admin user
      password: forms-flow-idm  # Password for the custom user to create
      username: forms-flow-idm  # Name for a custom user to create
    image:
      registry: "docker.io"
      repository: "bitnami/postgresql" 
      tag: 14.2.0-debian-10-r57
    fullnameOverride: "forms-flow-idm-postgresql"
    primary:
      containerSecurityContext:
        enabled: false
      persistence:
        storageClass: ""
        size: 2Gi 
      podSecurityContext:
        enabled: false
      service:
        ports:
          postgresql: 5432  # PostgreSQL service port
      shmVolume:
        chmod:
          enabled: false
    volumePermissions:
      containerSecurityContext:
        runAsUser: "auto"

  resources:
    limits:
      cpu: 2
      memory: 3Gi
    requests:
      cpu: 1.6
      memory: 2Gi

  containerSecurityContext:
    enabled: false
  podSecurityContext:
    enabled: false

  keycloakConfigCli:
    containerSecurityContext:
      enabled: false
    podSecurityContext:
      enabled: false
  
  ingress:
    enabled: true
    extraTls:
      - {}
    hostname: #DEFINE_ME
    pathtype: Prefix
    servicePort: http
    tls: true

  httpRelativePath: /auth/
